<header class="page-header">
  <h1>{{ec.group.name}}</h1>
  <div class="chapters">
    <span class="item">
      <a href="#/{{ec.group.id}}/entries/all/{{ec.year}}/{{ec.month}}">*</a>
    </span>
    <span data-ng-repeat="id in ec.chaptersMap[ec.chapterId].ids" class="item">
      <a href="#/{{ec.group.id}}/entries/chapter/{{id}}/{{ec.year}}/{{ec.month}}">{{ec.chaptersMap[id].name}}</a>
    </span>
  </div>
  <div>
    <span data-bs-dropdown>{{({true:ec.month,false:'*'})[ec.month!=undefined]}}<span class="caret"></span></span>
    <ul class="dropdown-menu" role="menu">
      <li data-ng-repeat="m in [1,2,3,4,5,6,7,8,9,10,11,12]">
        <a data-ng-show="ec.chapterId" href="#/{{ec.group.id}}/entries/chapter/{{ec.chapterId}}/{{ec.year}}/{{m}}">{{m}}</a>
        <a data-ng-hide="ec.chapterId" href="#/{{ec.group.id}}/entries/all/{{ec.year}}/{{m}}">{{m}}</a>
      </li>
      <li role="separator" class="divider"></li>
      <li>
        <a data-ng-show="ec.chapterId" href="#/{{ec.group.id}}/entries/chapter/{{ec.chapterId}}/{{ec.year}}/{{m}}">*</a>
        <a data-ng-hide="ec.chapterId" href="#/{{ec.group.id}}/entries/all/{{ec.year}}/">*</a>
      </li>
    </ul>
    /
    <span data-bs-dropdown>{{ec.year}}<span class="caret"></span></span>
    <ul class="dropdown-menu" role="menu">
      <li data-ng-repeat="y in [ec.year-2, ec.year-1, ec.year, ec.year+1, ec.year+2]">
        <a data-ng-show="ec.chapterId" href="#/{{ec.group.id}}/entries/chapter/{{ec.chapterId}}/{{y}}/{{ec.month}}">{{ym}}</a>
        <a data-ng-hide="ec.chapterId" href="#/{{ec.group.id}}/entries/all/{{y}}/{{ec.month}}">{{y}}</a>
      </li>
    </ul>
  </div>
</header>

<table class="table table-striped table-hover table-condensed entries-table">
  <colgroup>
    <col style="width: 1cm"/>
    <col style="width: 2cm"/>
    <col style="width: 4cm"/>
    <col style="width: 5cm"/>
    <col style="width: 6cm"/>
  </colgroup>
  <thead>
    <tr>
      <th></th>
      <th>Date</th>
      <th>Amount</th>
      <th>Chapter and payee</th>
      <th>People</th>
      <th>Details</th>
    </tr>
  </thead>
  <tbody>
    <tr data-ng-repeat="entry in ec.entries|orderBy:'date':true">
      <td class="controls">
      </td>
      <td class="date">
        {{entry.date|date:mc.dateFormats.short}}
      </td>
      <td class="amount-currency">
        <span data-fa-amount data-amount="entry.amount"></span>
      </td>
      <td>
        <div class="chapters">
          <span data-ng-repeat="id in ec.chaptersMap[entry.chapterKey.id].ids" class="item">
            <a href="#/{{ec.group.id}}/entries/chapter/{{id}}/{{ec.year}}/{{ec.month}}">{{ec.chaptersMap[id].name}}</a>
          </span>
        </div>
        <div>{{entry.payee}}</div>
      </td>
      <td>
        <div data-ng-repeat="type in ['by', 'for']" class="entry-users">
          <span class="inline-label">{{type}}:</span>
          <span data-fa-shares data-shares="entry[type+'Shares']"
                data-percentage="entry[type+'Percentage']"
                data-amount-value="entry.amount.value"
                data-users-map="ec.usersMap"></span>
        </div>
      </td>
      <td>
        <div class="description">
          {{entry.description}}
        </div>
        <div>
          <span data-ng-repeat="tag in entry.tags|orderBy:'+'" class="badge">{{tag}}</span>
          <span class="notes">{{entry.notes}}</span>
        </div>
      </td>
    </tr>
  </tbody>
</table>